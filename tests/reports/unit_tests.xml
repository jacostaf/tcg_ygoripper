<?xml version="1.0" encoding="utf-8"?><testsuites><testsuite name="pytest" errors="0" failures="3" skipped="0" tests="224" time="2.954" timestamp="2025-07-16T11:06:16.365583" hostname="Joses-MacBook-Air.local"><testcase classname="tests.unit.test_app.TestAppCreation" name="test_create_app_default_config" time="0.013" /><testcase classname="tests.unit.test_app.TestAppCreation" name="test_create_app_registers_routes" time="0.005" /><testcase classname="tests.unit.test_app.TestAppCreation" name="test_create_app_cors_enabled" time="0.010" /><testcase classname="tests.unit.test_app.TestAppCreation" name="test_health_endpoint_available" time="0.014" /><testcase classname="tests.unit.test_app.TestAppCreation" name="test_404_error_handler" time="0.012" /><testcase classname="tests.unit.test_app.TestAppCreation" name="test_memory_manager_integration" time="0.017" /><testcase classname="tests.unit.test_app.TestAppCreation" name="test_database_connection_handling" time="0.012" /><testcase classname="tests.unit.test_app.TestAppCreation" name="test_config_validation" time="0.011" /><testcase classname="tests.unit.test_app.TestAppCreation" name="test_config_validation_failure" time="0.003" /><testcase classname="tests.unit.test_app.TestAppCreation" name="test_app_context_creation" time="0.009" /><testcase classname="tests.unit.test_app.TestAppCreation" name="test_request_context_creation" time="0.010" /><testcase classname="tests.unit.test_app.TestRunApp" name="test_run_app_debug_mode" time="0.004" /><testcase classname="tests.unit.test_app.TestRunApp" name="test_run_app_production_mode" time="0.004"><failure message="AttributeError: &lt;module 'ygoapi.app' from '/Users/joseacosta/Desktop/BMAD/yugiohProjectBmad/tcg_ygoripper/ygoapi/app.py'&gt; does not have the attribute 'serve'">self = &lt;test_app.TestRunApp object at 0x110bdc4f0&gt;
mock_create_app = &lt;MagicMock name='create_app' id='4579745744'&gt;
mock_get_port = &lt;MagicMock name='get_port' id='4579885792'&gt;
mock_get_debug = &lt;MagicMock name='get_debug_mode' id='4579758432'&gt;

    @patch.dict(os.environ, {"DISABLE_DB_CONNECTION": "1"})
    @patch("ygoapi.app.get_debug_mode")
    @patch("ygoapi.app.get_port")
    @patch("ygoapi.app.create_app")
    def test_run_app_production_mode(self, mock_create_app, mock_get_port, mock_get_debug):
        """Test running app in production mode."""
        mock_app = Mock()
        mock_create_app.return_value = mock_app
        mock_get_port.return_value = 8080
        mock_get_debug.return_value = False
    
        # Mock the serve function that gets imported conditionally
&gt;       with patch("ygoapi.app.serve") as mock_serve:

tests/unit/test_app.py:162: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../../../../.pyenv/versions/3.9.7/lib/python3.9/unittest/mock.py:1405: in __enter__
    original, local = self.get_original()
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;unittest.mock._patch object at 0x111039c10&gt;

    def get_original(self):
        target = self.getter()
        name = self.attribute
    
        original = DEFAULT
        local = False
    
        try:
            original = target.__dict__[name]
        except (AttributeError, KeyError):
            original = getattr(target, name, DEFAULT)
        else:
            local = True
    
        if name in _builtins and isinstance(target, ModuleType):
            self.create = True
    
        if not self.create and original is DEFAULT:
&gt;           raise AttributeError(
                "%s does not have the attribute %r" % (target, name)
            )
E           AttributeError: &lt;module 'ygoapi.app' from '/Users/joseacosta/Desktop/BMAD/yugiohProjectBmad/tcg_ygoripper/ygoapi/app.py'&gt; does not have the attribute 'serve'

../../../../.pyenv/versions/3.9.7/lib/python3.9/unittest/mock.py:1378: AttributeError</failure></testcase><testcase classname="tests.unit.test_app.TestDatabaseIntegration" name="test_app_creation_with_failed_database_allowed" time="0.015" /><testcase classname="tests.unit.test_app.TestDatabaseIntegration" name="test_app_creation_with_failed_database_not_allowed" time="0.006" /><testcase classname="tests.unit.test_app.TestLogging" name="test_logging_configuration" time="0.011" /><testcase classname="tests.unit.test_app.TestRouteRegistration" name="test_api_endpoints_registered" time="0.016" /><testcase classname="tests.unit.test_app.TestRouteRegistration" name="test_route_logging" time="0.059" /><testcase classname="tests.unit.test_app.TestCORSConfiguration" name="test_cors_origins" time="0.012" /><testcase classname="tests.unit.test_app.TestCORSConfiguration" name="test_cors_methods" time="0.023" /><testcase classname="tests.unit.test_app.TestErrorScenarios" name="test_500_error_handling" time="0.015" /><testcase classname="tests.unit.test_app.TestErrorScenarios" name="test_method_not_allowed" time="0.031" /><testcase classname="tests.unit.test_app.TestAppConfiguration" name="test_debug_mode_configuration" time="0.028" /><testcase classname="tests.unit.test_app.TestAppConfiguration" name="test_port_configuration" time="0.009" /><testcase classname="tests.unit.test_card_services.TestCardSetService" name="test_fetch_all_card_sets_success" time="0.002" /><testcase classname="tests.unit.test_card_services.TestCardSetService" name="test_fetch_all_card_sets_api_error" time="0.018" /><testcase classname="tests.unit.test_card_services.TestCardSetService" name="test_fetch_all_card_sets_network_error" time="0.003" /><testcase classname="tests.unit.test_card_services.TestCardSetService" name="test_upload_card_sets_to_cache_success" time="0.004" /><testcase classname="tests.unit.test_card_services.TestCardSetService" name="test_get_cached_card_sets_success" time="0.003" /><testcase classname="tests.unit.test_card_services.TestCardSetService" name="test_get_cached_card_sets_database_disabled" time="0.003" /><testcase classname="tests.unit.test_card_services.TestCardSetService" name="test_get_card_sets_count_success" time="0.003" /><testcase classname="tests.unit.test_card_services.TestCardSetService" name="test_search_card_sets_success" time="0.003" /><testcase classname="tests.unit.test_card_services.TestCardVariantService" name="test_fetch_cards_from_set_success" time="0.006" /><testcase classname="tests.unit.test_card_services.TestCardVariantService" name="test_fetch_cards_from_set_not_found" time="0.003" /><testcase classname="tests.unit.test_card_services.TestCardVariantService" name="test_fetch_cards_from_set_api_error" time="0.004" /><testcase classname="tests.unit.test_card_services.TestCardVariantService" name="test_create_card_variants_success" time="0.007" /><testcase classname="tests.unit.test_card_services.TestCardVariantService" name="test_create_card_variants_empty_input" time="0.002" /><testcase classname="tests.unit.test_card_services.TestCardVariantService" name="test_create_card_variants_malformed_data" time="0.003" /><testcase classname="tests.unit.test_card_services.TestCardVariantService" name="test_upload_card_variants_to_cache_success" time="0.118" /><testcase classname="tests.unit.test_card_services.TestCardVariantService" name="test_get_cached_card_variants_success" time="0.004" /><testcase classname="tests.unit.test_card_services.TestCardLookupService" name="test_lookup_card_info_from_cache_success" time="0.002" /><testcase classname="tests.unit.test_card_services.TestCardLookupService" name="test_lookup_card_info_from_cache_not_found" time="0.002" /><testcase classname="tests.unit.test_card_services.TestCardLookupService" name="test_lookup_card_info_from_cache_database_error" time="0.003" /><testcase classname="tests.unit.test_card_services.TestCardLookupService" name="test_lookup_card_name_from_ygo_api_success" time="0.003" /><testcase classname="tests.unit.test_card_services.TestCardLookupService" name="test_lookup_card_name_from_ygo_api_not_found" time="0.002" /><testcase classname="tests.unit.test_card_services.TestCardLookupService" name="test_lookup_card_name_from_ygo_api_network_error" time="0.003" /><testcase classname="tests.unit.test_card_services.TestServiceInstances" name="test_service_instances_exist" time="0.002" /><testcase classname="tests.unit.test_card_services.TestServiceInstances" name="test_service_instances_have_memory_manager" time="0.004" /><testcase classname="tests.unit.test_card_services.TestIntegrationScenarios" name="test_complete_card_set_workflow" time="0.003" /><testcase classname="tests.unit.test_card_services.TestIntegrationScenarios" name="test_error_handling_cascade" time="0.003" /><testcase classname="tests.unit.test_database" name="test_database_connection" time="0.002" /><testcase classname="tests.unit.test_database.TestDatabaseManager" name="test_init" time="0.002" /><testcase classname="tests.unit.test_database.TestDatabaseManager" name="test_get_client_success" time="0.003" /><testcase classname="tests.unit.test_database.TestDatabaseManager" name="test_get_client_connection_failure_with_fallback" time="0.005" /><testcase classname="tests.unit.test_database.TestDatabaseManager" name="test_get_client_total_failure" time="0.003" /><testcase classname="tests.unit.test_database.TestDatabaseManager" name="test_get_client_disabled" time="0.002" /><testcase classname="tests.unit.test_database.TestDatabaseManager" name="test_get_client_cached" time="0.003" /><testcase classname="tests.unit.test_database.TestDatabaseManager" name="test_get_database_success" time="0.003" /><testcase classname="tests.unit.test_database.TestDatabaseManager" name="test_get_database_client_none" time="0.001" /><testcase classname="tests.unit.test_database.TestDatabaseManager" name="test_get_database_disabled" time="0.002" /><testcase classname="tests.unit.test_database.TestDatabaseManager" name="test_get_database_cached" time="0.002" /><testcase classname="tests.unit.test_database.TestDatabaseManager" name="test_get_collection_success" time="0.004" /><testcase classname="tests.unit.test_database.TestDatabaseManager" name="test_get_collection_database_none" time="0.003" /><testcase classname="tests.unit.test_database.TestDatabaseManager" name="test_get_card_sets_collection" time="0.003" /><testcase classname="tests.unit.test_database.TestDatabaseManager" name="test_get_card_sets_collection_disabled" time="0.003" /><testcase classname="tests.unit.test_database.TestDatabaseManager" name="test_cleanup_connections" time="0.002" /><testcase classname="tests.unit.test_database.TestDatabaseManager" name="test_cleanup_connections_with_exception" time="0.001" /><testcase classname="tests.unit.test_database.TestDatabaseManager" name="test_close" time="0.002" /><testcase classname="tests.unit.test_database.TestDatabaseManager" name="test_test_connection_success" time="0.004" /><testcase classname="tests.unit.test_database.TestDatabaseManager" name="test_test_connection_failure" time="0.002" /><testcase classname="tests.unit.test_database.TestDatabaseManager" name="test_test_connection_disabled" time="0.002" /><testcase classname="tests.unit.test_database.TestDatabaseManager" name="test_get_connection_context_manager" time="0.002" /><testcase classname="tests.unit.test_database.TestDatabaseManager" name="test_get_connection_disabled" time="0.002" /><testcase classname="tests.unit.test_database.TestDatabaseManager" name="test_get_database_context" time="0.002" /><testcase classname="tests.unit.test_database.TestDatabaseManager" name="test_get_collection_context" time="0.003" /><testcase classname="tests.unit.test_database.TestGlobalFunctions" name="test_get_database_manager_singleton" time="0.001" /><testcase classname="tests.unit.test_database.TestGlobalFunctions" name="test_get_mongo_client" time="0.002" /><testcase classname="tests.unit.test_database.TestGlobalFunctions" name="test_get_database_function" time="0.002" /><testcase classname="tests.unit.test_database.TestGlobalFunctions" name="test_get_collection_function" time="0.002" /><testcase classname="tests.unit.test_database.TestGlobalFunctions" name="test_get_card_sets_collection_function" time="0.003" /><testcase classname="tests.unit.test_database.TestGlobalFunctions" name="test_get_card_variants_collection_function" time="0.004" /><testcase classname="tests.unit.test_database.TestGlobalFunctions" name="test_get_price_cache_collection_function" time="0.004" /><testcase classname="tests.unit.test_database.TestGlobalFunctions" name="test_close_database_connections" time="0.003" /><testcase classname="tests.unit.test_database.TestGlobalFunctions" name="test_test_database_connection_function" time="0.001" /><testcase classname="tests.unit.test_database.TestErrorHandling" name="test_connection_timeout_error" time="0.002" /><testcase classname="tests.unit.test_database.TestErrorHandling" name="test_ssl_error_handling" time="0.003" /><testcase classname="tests.unit.test_database.TestMemoryManagement" name="test_memory_manager_callback_registration" time="0.003" /><testcase classname="tests.unit.test_database.TestMemoryManagement" name="test_memory_monitoring_decorators" time="0.003" /><testcase classname="tests.unit.test_database.TestContextManagers" name="test_get_connection_context_manager_cleanup" time="0.004" /><testcase classname="tests.unit.test_models.TestPyObjectId" name="test_valid_object_id" time="0.002" /><testcase classname="tests.unit.test_models.TestPyObjectId" name="test_valid_object_id_string" time="0.002" /><testcase classname="tests.unit.test_models.TestPyObjectId" name="test_invalid_object_id" time="0.001" /><testcase classname="tests.unit.test_models.TestPyObjectId" name="test_validators_generator" time="0.001" /><testcase classname="tests.unit.test_models.TestPyObjectId" name="test_pydantic_json_schema" time="0.002" /><testcase classname="tests.unit.test_models.TestCardPriceModel" name="test_valid_card_price_model" time="0.004" /><testcase classname="tests.unit.test_models.TestCardPriceModel" name="test_card_price_model_with_art_variant" time="0.002" /><testcase classname="tests.unit.test_models.TestCardPriceModel" name="test_card_price_model_optional_fields" time="0.003" /><testcase classname="tests.unit.test_models.TestCardPriceModel" name="test_card_price_model_missing_required_field" time="0.002" /><testcase classname="tests.unit.test_models.TestCardPriceModel" name="test_card_price_model_json_serialization" time="0.002" /><testcase classname="tests.unit.test_models.TestCardSetModel" name="test_valid_card_set_model" time="0.002" /><testcase classname="tests.unit.test_models.TestCardSetModel" name="test_card_set_model_optional_fields" time="0.002" /><testcase classname="tests.unit.test_models.TestCardSetModel" name="test_card_set_model_with_metadata" time="0.001" /><testcase classname="tests.unit.test_models.TestCardSetModel" name="test_card_set_model_invalid_num_cards" time="0.002" /><testcase classname="tests.unit.test_models.TestCardVariantModel" name="test_valid_card_variant_model" time="0.002" /><testcase classname="tests.unit.test_models.TestCardVariantModel" name="test_card_variant_model_def_alias" time="0.005" /><testcase classname="tests.unit.test_models.TestCardVariantModel" name="test_card_variant_model_with_set_info" time="0.001" /><testcase classname="tests.unit.test_models.TestCardVariantModel" name="test_card_variant_model_with_linkmarkers" time="0.001" /><testcase classname="tests.unit.test_models.TestCardVariantModel" name="test_card_variant_model_missing_required_fields" time="0.001" /><testcase classname="tests.unit.test_models.TestCardModel" name="test_valid_card_model" time="0.002" /><testcase classname="tests.unit.test_models.TestCardModel" name="test_card_model_with_card_sets" time="0.001" /><testcase classname="tests.unit.test_models.TestCardModel" name="test_card_model_with_images_and_prices" time="0.001" /><testcase classname="tests.unit.test_models.TestCardModel" name="test_card_model_required_fields_only" time="0.001" /><testcase classname="tests.unit.test_models.TestProcessingStats" name="test_valid_processing_stats" time="0.003" /><testcase classname="tests.unit.test_models.TestProcessingStats" name="test_processing_stats_with_errors" time="0.002" /><testcase classname="tests.unit.test_models.TestProcessingStats" name="test_processing_stats_defaults" time="0.002" /><testcase classname="tests.unit.test_models.TestPriceScrapingRequest" name="test_valid_price_scraping_request" time="0.002" /><testcase classname="tests.unit.test_models.TestPriceScrapingRequest" name="test_price_scraping_request_defaults" time="0.001" /><testcase classname="tests.unit.test_models.TestPriceScrapingRequest" name="test_price_scraping_request_missing_fields" time="0.001" /><testcase classname="tests.unit.test_models.TestPriceScrapingResponse" name="test_valid_price_scraping_response" time="0.001" /><testcase classname="tests.unit.test_models.TestPriceScrapingResponse" name="test_price_scraping_response_error" time="0.002" /><testcase classname="tests.unit.test_models.TestPriceScrapingResponse" name="test_price_scraping_response_json_serialization" time="0.003" /><testcase classname="tests.unit.test_models.TestMemoryStats" name="test_valid_memory_stats" time="0.002" /><testcase classname="tests.unit.test_models.TestMemoryStats" name="test_memory_stats_invalid_types" time="0.001" /><testcase classname="tests.unit.test_models.TestModelValidation" name="test_extra_fields_ignored" time="0.001" /><testcase classname="tests.unit.test_models.TestModelValidation" name="test_model_dict_conversion" time="0.002" /><testcase classname="tests.unit.test_models.TestModelValidation" name="test_model_copy" time="0.002" /><testcase classname="tests.unit.test_models.TestModelValidation" name="test_model_update" time="0.002" /><testcase classname="tests.unit.test_price_scraping.TestPriceScrapingService" name="test_init_with_disabled_db" time="0.003" /><testcase classname="tests.unit.test_price_scraping.TestPriceScrapingService" name="test_validate_card_rarity_success" time="0.004" /><testcase classname="tests.unit.test_price_scraping.TestPriceScrapingService" name="test_validate_card_rarity_not_found" time="0.038" /><testcase classname="tests.unit.test_price_scraping.TestPriceScrapingService" name="test_validate_card_rarity_disabled_db" time="0.002" /><testcase classname="tests.unit.test_price_scraping.TestPriceScrapingService" name="test_lookup_card_name_success" time="0.003" /><testcase classname="tests.unit.test_price_scraping.TestPriceScrapingService" name="test_lookup_card_name_not_found" time="0.011" /><testcase classname="tests.unit.test_price_scraping.TestPriceScrapingService" name="test_find_cached_price_data_success" time="0.008" /><testcase classname="tests.unit.test_price_scraping.TestPriceScrapingService" name="test_find_cached_price_data_not_found" time="0.002" /><testcase classname="tests.unit.test_price_scraping.TestPriceScrapingService" name="test_get_cache_stats_success" time="0.004" /><testcase classname="tests.unit.test_price_scraping.TestPriceScrapingService" name="test_get_cache_stats_disabled_db" time="0.002" /><testcase classname="tests.unit.test_price_scraping.TestPriceScrapingService" name="test_scrape_card_price_success" time="0.003" /><testcase classname="tests.unit.test_price_scraping.TestPriceScrapingService" name="test_scrape_card_price_cached" time="0.003" /><testcase classname="tests.unit.test_price_scraping.TestPriceScrapingService" name="test_scrape_card_price_request_failure" time="0.002" /><testcase classname="tests.unit.test_price_scraping.TestPriceScrapingService" name="test_scrape_card_price_invalid_rarity" time="0.003" /><testcase classname="tests.unit.test_price_scraping.TestPriceScrapingService" name="test_save_price_to_cache_success" time="0.004" /><testcase classname="tests.unit.test_price_scraping.TestPriceScrapingService" name="test_save_price_to_cache_disabled_db" time="0.003" /><testcase classname="tests.unit.test_price_scraping.TestPriceScrapingIntegration" name="test_complete_scraping_workflow" time="0.005" /><testcase classname="tests.unit.test_price_scraping.TestPriceScrapingIntegration" name="test_cache_hit_workflow" time="0.003" /><testcase classname="tests.unit.test_price_scraping.TestPriceScrapingErrorHandling" name="test_network_timeout_handling" time="0.004" /><testcase classname="tests.unit.test_price_scraping.TestPriceScrapingErrorHandling" name="test_invalid_html_handling" time="0.004" /><testcase classname="tests.unit.test_price_scraping.TestPriceScrapingErrorHandling" name="test_http_error_handling" time="0.004" /><testcase classname="tests.unit.test_routes.TestRouteRegistration" name="test_register_routes" time="0.011" /><testcase classname="tests.unit.test_routes.TestHealthCheck" name="test_health_check_success" time="0.025" /><testcase classname="tests.unit.test_routes.TestCardPriceEndpoint" name="test_scrape_card_price_success" time="0.039" /><testcase classname="tests.unit.test_routes.TestCardPriceEndpoint" name="test_scrape_card_price_missing_json" time="0.029" /><testcase classname="tests.unit.test_routes.TestCardPriceEndpoint" name="test_scrape_card_price_missing_required_fields" time="0.026" /><testcase classname="tests.unit.test_routes.TestCardPriceEndpoint" name="test_scrape_card_price_empty_rarity" time="0.024" /><testcase classname="tests.unit.test_routes.TestCardPriceEndpoint" name="test_scrape_card_price_invalid_rarity" time="0.033" /><testcase classname="tests.unit.test_routes.TestCardPriceEndpoint" name="test_scrape_card_price_with_art_variant" time="0.071" /><testcase classname="tests.unit.test_routes.TestCardPriceEndpoint" name="test_scrape_card_price_cached_response" time="0.028" /><testcase classname="tests.unit.test_routes.TestCardPriceEndpoint" name="test_scrape_card_price_not_found" time="0.030" /><testcase classname="tests.unit.test_routes.TestCardPriceEndpoint" name="test_scrape_card_price_server_error" time="0.031" /><testcase classname="tests.unit.test_routes.TestPriceCacheStatsEndpoint" name="test_get_price_cache_stats_success" time="0.030" /><testcase classname="tests.unit.test_routes.TestPriceCacheStatsEndpoint" name="test_get_price_cache_stats_error" time="0.024" /><testcase classname="tests.unit.test_routes.TestCardSetsEndpoints" name="test_get_all_card_sets_success" time="0.078" /><testcase classname="tests.unit.test_routes.TestCardSetsEndpoints" name="test_search_card_sets_success" time="0.026" /><testcase classname="tests.unit.test_routes.TestCardSetsEndpoints" name="test_upload_card_sets_success" time="0.024" /><testcase classname="tests.unit.test_routes.TestCardSetsEndpoints" name="test_get_card_sets_from_cache_success" time="0.090" /><testcase classname="tests.unit.test_routes.TestCardSetsEndpoints" name="test_get_card_sets_count_success" time="0.024" /><testcase classname="tests.unit.test_routes.TestCardSetsCardsEndpoint" name="test_get_cards_from_specific_set_success" time="0.029" /><testcase classname="tests.unit.test_routes.TestCardSetsCardsEndpoint" name="test_get_cards_from_specific_set_not_found" time="0.021" /><testcase classname="tests.unit.test_routes.TestCardSetsCardsEndpoint" name="test_get_cards_from_specific_set_with_params" time="0.036" /><testcase classname="tests.unit.test_routes.TestCardVariantsEndpoints" name="test_upload_card_variants_success" time="0.021" /><testcase classname="tests.unit.test_routes.TestCardVariantsEndpoints" name="test_get_card_variants_from_cache_success" time="0.024" /><testcase classname="tests.unit.test_routes.TestMemoryEndpoints" name="test_get_memory_statistics_success" time="0.022" /><testcase classname="tests.unit.test_routes.TestMemoryEndpoints" name="test_force_memory_cleanup_success" time="0.023" /><testcase classname="tests.unit.test_routes.TestDebugEndpoints" name="test_debug_cache_lookup_success" time="0.069" /><testcase classname="tests.unit.test_routes.TestDebugEndpoints" name="test_debug_art_extraction_success" time="0.034" /><testcase classname="tests.unit.test_routes.TestImageProxyEndpoints" name="test_proxy_card_image_missing_url" time="0.020" /><testcase classname="tests.unit.test_routes.TestImageProxyEndpoints" name="test_proxy_card_image_invalid_domain" time="0.017" /><testcase classname="tests.unit.test_routes.TestImageProxyEndpoints" name="test_proxy_card_image_success" time="0.023" /><testcase classname="tests.unit.test_routes.TestImageProxyEndpoints" name="test_proxy_card_image_timeout" time="0.019" /><testcase classname="tests.unit.test_routes.TestImageProxyEndpoints" name="test_get_card_image_by_id_success" time="0.020" /><testcase classname="tests.unit.test_routes.TestImageProxyEndpoints" name="test_get_card_image_by_id_with_proxy" time="0.020" /><testcase classname="tests.unit.test_routes.TestErrorHandlers" name="test_404_handler" time="0.019" /><testcase classname="tests.unit.test_routes.TestRateLimiting" name="test_image_proxy_rate_limiting" time="0.020" /><testcase classname="tests.unit.test_routes.TestRequestValidation" name="test_price_endpoint_force_refresh_conversion" time="0.076" /><testcase classname="tests.unit.test_routes.TestRequestValidation" name="test_art_variant_handling" time="0.030" /><testcase classname="tests.unit.test_routes.TestFetchAllCardsEndpoint" name="test_fetch_all_cards_simplified_response" time="0.023" /><testcase classname="tests.unit.test_utils.TestCardDataCleaning" name="test_clean_card_data_with_datetime" time="0.002" /><testcase classname="tests.unit.test_utils.TestCardDataCleaning" name="test_clean_card_data_with_none_values" time="0.002" /><testcase classname="tests.unit.test_utils.TestCardDataCleaning" name="test_clean_card_data_empty_dict" time="0.002" /><testcase classname="tests.unit.test_utils.TestCardNumberValidation" name="test_validate_card_number_valid_formats" time="0.004" /><testcase classname="tests.unit.test_utils.TestCardNumberValidation" name="test_validate_card_number_invalid_formats" time="0.002" /><testcase classname="tests.unit.test_utils.TestCardNumberValidation" name="test_extract_set_code_valid_numbers" time="0.003" /><testcase classname="tests.unit.test_utils.TestCardNumberValidation" name="test_extract_set_code_invalid_numbers" time="0.003" /><testcase classname="tests.unit.test_utils.TestRarityProcessing" name="test_normalize_rarity_basic" time="0.004" /><testcase classname="tests.unit.test_utils.TestRarityProcessing" name="test_normalize_rarity_abbreviations" time="0.003" /><testcase classname="tests.unit.test_utils.TestRarityProcessing" name="test_normalize_rarity_for_matching" time="0.003" /><testcase classname="tests.unit.test_utils.TestRarityProcessing" name="test_normalize_rarity_empty_input" time="0.002" /><testcase classname="tests.unit.test_utils.TestRarityProcessing" name="test_map_rarity_to_tcgplayer_filter" time="0.008" /><testcase classname="tests.unit.test_utils.TestArtVersionExtraction" name="test_extract_art_version_numbered_patterns" time="0.005" /><testcase classname="tests.unit.test_utils.TestArtVersionExtraction" name="test_extract_art_version_named_patterns" time="0.002" /><testcase classname="tests.unit.test_utils.TestArtVersionExtraction" name="test_extract_art_version_no_pattern" time="0.002" /><testcase classname="tests.unit.test_utils.TestArtVersionExtraction" name="test_normalize_art_variant" time="0.004" /><testcase classname="tests.unit.test_utils.TestBoosterSetExtraction" name="test_extract_booster_set_name_from_url" time="0.002" /><testcase classname="tests.unit.test_utils.TestBoosterSetExtraction" name="test_extract_booster_set_name_invalid_url" time="0.002" /><testcase classname="tests.unit.test_utils.TestSetCodeMapping" name="test_map_set_code_to_tcgplayer_name_success" time="0.002"><failure message="AttributeError: __getitem__">self = &lt;test_utils.TestSetCodeMapping object at 0x110d8aa00&gt;
mock_get_database = &lt;MagicMock name='get_database' id='4582880304'&gt;

    @patch("ygoapi.database.get_database")  # Fix: Use correct import path
    def test_map_set_code_to_tcgplayer_name_success(self, mock_get_database):
        """Test successful set code mapping."""
        # Setup mock database and collection
        mock_db = Mock()
        mock_collection = Mock()
        mock_get_database.return_value = mock_db
&gt;       mock_db.__getitem__.return_value = mock_collection

tests/unit/test_utils.py:277: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;Mock name='get_database()' id='4582880064'&gt;, name = '__getitem__'

    def __getattr__(self, name):
        if name in {'_mock_methods', '_mock_unsafe'}:
            raise AttributeError(name)
        elif self._mock_methods is not None:
            if name not in self._mock_methods or name in _all_magics:
                raise AttributeError("Mock object has no attribute %r" % name)
        elif _is_magic(name):
&gt;           raise AttributeError(name)
E           AttributeError: __getitem__

../../../../.pyenv/versions/3.9.7/lib/python3.9/unittest/mock.py:632: AttributeError</failure></testcase><testcase classname="tests.unit.test_utils.TestSetCodeMapping" name="test_map_set_code_to_tcgplayer_name_fallback" time="0.002"><failure message="AttributeError: __getitem__">self = &lt;test_utils.TestSetCodeMapping object at 0x110d8ab20&gt;
mock_get_database = &lt;MagicMock name='get_database' id='4581025248'&gt;

    @patch("ygoapi.database.get_database")  # Fix: Use correct import path
    def test_map_set_code_to_tcgplayer_name_fallback(self, mock_get_database):
        """Test set code mapping with fallback."""
        # Setup mock database and collection
        mock_db = Mock()
        mock_collection = Mock()
        mock_get_database.return_value = mock_db
&gt;       mock_db.__getitem__.return_value = mock_collection

tests/unit/test_utils.py:295: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;Mock name='get_database()' id='4581024960'&gt;, name = '__getitem__'

    def __getattr__(self, name):
        if name in {'_mock_methods', '_mock_unsafe'}:
            raise AttributeError(name)
        elif self._mock_methods is not None:
            if name not in self._mock_methods or name in _all_magics:
                raise AttributeError("Mock object has no attribute %r" % name)
        elif _is_magic(name):
&gt;           raise AttributeError(name)
E           AttributeError: __getitem__

../../../../.pyenv/versions/3.9.7/lib/python3.9/unittest/mock.py:632: AttributeError</failure></testcase><testcase classname="tests.unit.test_utils.TestSetCodeMapping" name="test_map_set_code_to_tcgplayer_name_invalid" time="0.002" /><testcase classname="tests.unit.test_utils.TestCardFiltering" name="test_filter_cards_by_set_exact_match" time="0.003" /><testcase classname="tests.unit.test_utils.TestCardFiltering" name="test_filter_cards_by_set_no_matches" time="0.001" /><testcase classname="tests.unit.test_utils.TestCardFiltering" name="test_filter_cards_by_set_case_insensitive" time="0.001" /><testcase classname="tests.unit.test_utils.TestCardFiltering" name="test_filter_cards_by_set_missing_card_sets" time="0.001" /><testcase classname="tests.unit.test_utils.TestUtilityHelpers" name="test_batch_process_generator" time="0.002" /><testcase classname="tests.unit.test_utils.TestUtilityHelpers" name="test_calculate_success_rate" time="0.003" /><testcase classname="tests.unit.test_utils.TestUtilityHelpers" name="test_generate_variant_id" time="0.002" /><testcase classname="tests.unit.test_utils.TestUtilityHelpers" name="test_is_cache_fresh" time="0.002" /><testcase classname="tests.unit.test_utils.TestUtilityHelpers" name="test_sanitize_string" time="0.002" /><testcase classname="tests.unit.test_utils.TestUtilityHelpers" name="test_parse_price_string" time="0.002" /><testcase classname="tests.unit.test_utils.TestUtilityHelpers" name="test_get_current_utc_datetime" time="0.001" /><testcase classname="tests.unit.test_utils.TestUtilityHelpers" name="test_format_datetime_for_api" time="0.001" /><testcase classname="tests.unit.test_utils.TestErrorHandling" name="test_functions_handle_none_input" time="0.002" /><testcase classname="tests.unit.test_utils.TestErrorHandling" name="test_functions_handle_empty_string_input" time="0.004" /><testcase classname="tests.unit.test_utils.TestErrorHandling" name="test_edge_cases_and_boundary_conditions" time="0.002" /><testcase classname="tests.unit.test_utils.TestPerformanceConsiderations" name="test_large_dataset_handling" time="0.010" /><testcase classname="tests.unit.test_utils.TestPerformanceConsiderations" name="test_repeated_operations" time="0.003" /></testsuite></testsuites>